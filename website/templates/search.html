{% extends 'base.html' %} {% block body %}
<div class="container">
    <form action="" method="post">
        <div class="input-group mb-3">
          <input
            type="text"
            class="form-control"
            placeholder="Search for people, posts, or content..."
            aria-label="Search"
            aria-describedby="button-addon2"
            name="search"
            value="{{query}}"
            minlength="2"
          />
          <button class="btn btn-outline-primary" type="submit" id="button-addon2">
            <i class="fas fa-search"></i> Search
          </button>
        </div>
      </form>
    
  {% if query %}
  <h2>Showing results for "{{query}}"</h2>
  {% else %}
  <h2>Search Results</h2>
  <div class="alert alert-info">
    <i class="fas fa-info-circle"></i> 
    Enter a search term to find users and posts. You can search by name, email, or post content.
  </div>
  {% endif %}
  <h3>Users</h3>
  {% if users %}
  {% for search_user in users %}
  <div class="border p-3 mb-2" style="border-radius: 10px;">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        {% if search_user.profile_picture %}
          <img src="../static/profile_pictures/{{ search_user.profile_picture }}" 
               class="rounded-circle me-3" width="40" height="40" alt="Profile">
        {% else %}
          <div class="bg-secondary rounded-circle d-inline-flex align-items-center justify-content-center me-3" 
               style="width: 40px; height: 40px;">
            <i class="fas fa-user text-white"></i>
          </div>
        {% endif %}
        <div>
          <strong><a href="/profile/{{search_user.id}}" style="color: black; text-decoration: none;">{{ search_user.first_name }} {{ search_user.last_name }}</a></strong>
          <br>
          <small class="text-muted">{{ search_user.email }}</small>
        </div>
      </div>
      
      {% if search_user.id != user.id %}
        <form method="POST" action="{{ url_for('views.send_friend_request_route', user_id=search_user.id) }}">
          <button type="submit" class="btn btn-primary btn-sm">
            <i class="fas fa-user-plus"></i> Add Friend
          </button>
        </form>
      {% endif %}
    </div>
  </div>
  {% endfor %}
  {% else %} 
    <p class="text-muted">There are no users matching your search.</p>
  {% endif %}
<br>
  <h3>Posts</h3>
  {% if posts %}
  {% for post, user in posts %}
  <div class="border" style="border-radius: 10px; padding: 5px">
    <small><a href="/profile/{{user.id}}" style="color: #6e8898; text-decoration: none;">{{ user.first_name }} {{ user.last_name }}</a></small>

    <h5><strong><a href="/post/{{post.id}}" style="color:black;">{{ post.title }}</a></strong></h5>
    <p>{{ post.content | nl2br }}</p>
    {% if current_user.id == post.user_id %}
    <!-- <small
      ><a
        href="/delete/post/{{post.id}}"
        onclick="return confirm('Are you sure you want to delete this post?')"
        >Delete Post</a
      ></small
    > -->
    {% else %}{% endif %}
  </div>
  <br />
  {% endfor %}{%else%} There are no posts matching your search.{% endif %}


</div>
{% endblock %}
